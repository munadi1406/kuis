const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/ChangePassword.Bfk99MzK.js","_astro/jsx-runtime.B6Q2Q8rY.js","_astro/index.caxmlYbZ.js","_astro/dialog.C3FXW3zP.js","_astro/react-icons.esm.Bl5TofSn.js","_astro/index.BT_cHE16.js","_astro/Combination.bo6dpEKa.js","_astro/index.UvFsUNS0.js","_astro/input.C4_IcoYx.js","_astro/index.CxOCE76-.js","_astro/button.4wA_-35M.js","_astro/useMutation.CWFg6o0r.js","_astro/WithQuery.DnMMxJSk.js","_astro/use-toast.FdKHRWm9.js"])))=>i.map(i=>d[i]);
import{_ as q}from"./preload-helper.BiBI96sQ.js";import{j as e}from"./jsx-runtime.B6Q2Q8rY.js";import{h as z,T as K,b as Q,c as J,d as S,e as i,f as X,g as n}from"./generatePdf.Bzozffwp.js";import{L as o,I as c}from"./input.C4_IcoYx.js";import{B as d}from"./button.4wA_-35M.js";import{D,f as y,a as v,b as k,c as T,g as Y,e as Z}from"./dialog.C3FXW3zP.js";import{r}from"./index.caxmlYbZ.js";import{u as j}from"./useMutation.CWFg6o0r.js";import{W as ee,a as g}from"./WithQuery.DnMMxJSk.js";import{S as se,a as ae,b as re,c as te,d as E}from"./select.Cho6iDwW.js";import{t as U}from"./use-toast.FdKHRWm9.js";import"./react-icons.esm.Bl5TofSn.js";import"./index.BT_cHE16.js";import"./index.CxOCE76-.js";import"./Combination.bo6dpEKa.js";import"./index.UvFsUNS0.js";import"./index.bGmHf_Qs.js";import"./index.C7eCcQ7I.js";import"./index.D2UOOlok.js";import"./index.DLkKLInH.js";import"./index.BQ-noFVk.js";const le=r.lazy(()=>q(()=>import("./ChangePassword.Bfk99MzK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),ie=()=>{const[P,R]=r.useState({}),[F,x]=r.useState(!1),[B,b]=r.useState(!1),[l,I]=r.useState([]),[f,N]=r.useState(!1),[O,_]=r.useState({username:"",id:0}),A=({username:s,id:a})=>{_({username:s,id:a})},[L,H]=r.useState(""),m=s=>{const a=s.target.name;R(t=>({...t,[a]:s.target.value}))},M=r.useRef(),V=j({mutationFn:async s=>(s.preventDefault(),await g.post("api/auth/register",P)),onSuccess:s=>{x(!1),window.location.reload()},onError:s=>{H(s.response.data.message)}}),w=j({mutationFn:async s=>await g.post("api/user/role",s),onSuccess:s=>{U({title:"Berhasil",description:"Role Berhasil Di ubah"})},onError:s=>{U({title:"Gagal",variant:"destructive",description:"Role Gagal Di ubah"})}}),C=async s=>{try{const t=(await g.get(`/api/user/data?search=${s}`)).data.data;return I(t),t}catch(a){throw console.error("Error fetching user data:",a),a}},G=j({mutationFn:async s=>await C(s)});let p;const W=s=>{const a=s.target.value;a.length>3?(N(!0),p&&clearTimeout(p),p=setTimeout(async()=>{G.mutate(a)},2e3)):N(!1)};return r.useEffect(()=>{f||C("")},[f]),e.jsxs("div",{className:"border rounded-md",children:[e.jsxs("div",{className:"w-full flex justify-between items-end  border-b  p-2",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"search",children:"Search"}),e.jsx(c,{type:"search",id:"search",placeholder:"Search",onChange:W})]}),e.jsxs("div",{className:"flex items-end justify-end gap-2",children:[e.jsxs(D,{open:F,onOpenChange:x,children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{variant:"outline",onClick:()=>x(!0),children:"Buat Akun"})}),e.jsxs(v,{className:"sm:max-w-[425px]",children:[e.jsxs(k,{children:[e.jsx(T,{children:"Buat Akun"}),e.jsx(Y,{className:"text-red-600 text-xs",children:L})]}),e.jsxs("form",{autoComplete:"false",onSubmit:V.mutate,method:"post",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"email",className:"text-right",children:"Email"}),e.jsx(c,{id:"email",name:"email",type:"email",className:"col-span-3",onChange:m})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"username",className:"text-right",children:"Username"}),e.jsx(c,{id:"username",name:"username",className:"col-span-3",onChange:m})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"password",className:"text-right",children:"Password"}),e.jsx(c,{id:"password",name:"password",type:"password",className:"col-span-3",onChange:m})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"confPassword",className:"text-right",children:"Konfirmasi Password"}),e.jsx(c,{id:"confPassword",type:"password",className:"col-span-3",onChange:m,name:"passwordConfirm"})]})]}),e.jsx(Z,{children:e.jsx(d,{type:"submit",children:"Buat Akun "})})]})]})]}),e.jsxs(D,{children:[e.jsx(y,{asChild:!0,children:e.jsx(d,{children:"Cetak"})}),e.jsxs(v,{className:"sm:max-w-[900px]",children:[e.jsx(k,{children:e.jsx(T,{children:"Cetak"})}),e.jsx("div",{children:e.jsxs("div",{ref:M,children:[e.jsx("div",{className:"w-full mb-4 text-center text-xl font-semibold uppercase underline underline-offset-2",children:"Laporan Surat Masuk"}),e.jsxs("table",{className:"border-collapse border border-black w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-black py-2",children:"No"}),e.jsx("th",{className:"border border-black py-2",children:"Username"}),e.jsx("th",{className:"border border-black py-2",children:"Email"}),e.jsx("th",{className:"border border-black py-2",children:"Role"})]})}),e.jsx("tbody",{children:l&&l.map(({email:s,username:a,role:t,id:u},h)=>t!=="admin"&&e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black text-center p-1 ",children:h+1}),e.jsx("td",{className:"border border-black p-1",children:a}),e.jsx("td",{className:"border border-black p-1",children:s}),e.jsx("td",{className:"border border-black p-1",children:t})]},h))})]})]})}),e.jsx(d,{className:"w-max ",onClick:()=>z(l),children:"Cetak"})]})]})]})]}),e.jsxs(K,{children:[e.jsx(Q,{children:"Daftar Users"}),e.jsx(J,{children:e.jsxs(S,{children:[e.jsx(i,{children:"No"}),e.jsx(i,{children:"Username"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Role"}),e.jsx(i,{children:"Action"})]})}),e.jsx(X,{children:l&&l.map(({email:s,username:a,role:t,id_user:u},h)=>e.jsxs(S,{children:[e.jsx(n,{className:"font-medium",children:h+1}),e.jsx(n,{className:"font-medium",children:a}),e.jsx(n,{className:"font-medium",children:s}),e.jsx(n,{className:"font-medium",children:e.jsxs(se,{onValueChange:$=>w.mutate({role:$,id:u}),disabled:w.isPending,children:[e.jsx(ae,{className:"w-[180px]",children:e.jsx(re,{placeholder:t})}),e.jsxs(te,{children:[e.jsx(E,{value:"admin",children:"Admin"}),e.jsx(E,{value:"users",children:"Users"})]})]})}),e.jsx(n,{children:e.jsx(d,{onClick:()=>{b(!0),A({username:a,id:u})},children:"Edit"})})]},s))})]}),e.jsx(le,{isDialogOpen:B,setIsDialogOpen:b,data:O})]})},Te=ee(ie);export{Te as default};
